<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security" lang="es">
<head th:replace="~{layout/layout :: head}">
	<title>Mis Empresas - SAMYX</title>
</head>
<body>
<div id="main-wrapper">
	<!-- Header -->
	<header th:replace="~{layout/layout :: header}"></header>

	<!-- Page Content -->
	<main class="py-5">
		<div class="container-fluid">

			<!-- Page Header -->
			<div class="row mb-5">
				<div class="col-md-8">
					<h1 class="h2 mb-1">
						<i class="fas fa-building me-2"></i>Mis Empresas
					</h1>
					<p class="text-muted mb-0">Selecciona una empresa para continuar trabajando</p>
				</div>
				<div class="col-md-4 text-md-end">
					<a sec:authorize="hasAnyRole('ROLE_ADMIN','ROLE_USER')"
						 class="btn btn-primary btn-lg"
						 th:href="@{/emisor/registrar-empresa/}">
						<i class="fas fa-plus-circle me-2"></i>Nueva Empresa
					</a>
				</div>
			</div>

			<!-- Empty State -->
			<div th:if="${#lists.isEmpty(listaEmisor)}" class="row">
				<div class="col-12">
					<div class="card border-0 shadow-lg">
						<div class="card-body py-5 text-center">
							<div class="mb-4">
								<i class="fas fa-inbox" style="font-size: 3rem; color: #ccc;"></i>
							</div>
							<h3 class="mb-2">No hay empresas registradas</h3>
							<p class="text-muted mb-4">Comienza registrando tu primera empresa para continuar</p>
							<a sec:authorize="hasAnyRole('ROLE_ADMIN','ROLE_USER')"
								 class="btn btn-primary"
								 th:href="@{/emisor/registrar-empresa/}">
								<i class="fas fa-plus-circle me-2"></i>Registrar Nueva Empresa
							</a>
						</div>
					</div>
				</div>
			</div>

			<!-- Grid de Empresas -->
			<div class="row g-4" th:if="${!#lists.isEmpty(listaEmisor)}">
				<div class="col-lg-4 col-md-6" th:each="empresa : ${listaEmisor}">
					<div class="card empresa-card h-100 shadow-sm transition-all"
							 th:classappend="${!empresa.emisor.statusEmpresa} ? 'empresa-inactive' : ''">

						<!-- Card Header -->
						<div class="card-header bg-light border-0 pb-0">
							<div class="d-flex justify-content-between align-items-start">
								<div class="empresa-icon bg-primary bg-opacity-10 rounded-circle p-3">
									<i class="fas fa-building text-primary" style="font-size: 1.5rem;"></i>
								</div>
								<span class="badge"
											th:classappend="${empresa.emisor.statusEmpresa} ? 'bg-success' : 'bg-secondary'">
									<span th:text="${empresa.emisor.statusEmpresa} ? 'Activa' : 'Inactiva'"></span>
								</span>
							</div>
						</div>

						<!-- Card Body -->
						<div class="card-body">
							<h5 class="card-title mb-3" th:text="${empresa.emisor.nombreRazonSocial}"></h5>

							<!-- Info Items -->
							<div class="info-group mb-3">
								<small class="text-muted d-block">Identificación</small>
								<span class="d-block fw-medium" th:text="${empresa.emisor.identificacion}"></span>
							</div>

							<div class="info-group mb-3">
								<small class="text-muted d-block">Correo</small>
								<a th:href="'mailto:' + ${empresa.emisor.email}"
									 class="text-primary text-decoration-none"
									 th:text="${empresa.emisor.email}"></a>
							</div>

							<div class="info-group mb-3" th:if="${empresa.emisor.telefono}">
								<small class="text-muted d-block">Teléfono</small>
								<span class="d-block" th:text="${empresa.emisor.telefono}"></span>
							</div>

							<div class="info-group" th:if="${empresa.emisor.fechaCaducidadCert != null}">
								<small class="text-muted d-block">Certificado vence</small>
								<span class="d-block fw-medium"
											th:text="${#dates.format(empresa.emisor.fechaCaducidadCert, 'dd/MM/yyyy')}"></span>
							</div>
						</div>

						<!-- Card Footer -->
						<div class="card-footer bg-light border-0 pt-0">
							<div class="d-grid gap-2">
								<a class="btn btn-primary btn-sm"
									 th:href="@{/emisor/ingresar/}+${empresa.emisor.id}">
									<i class="fas fa-sign-in-alt me-2"></i>Ingresar
								</a>
								<a sec:authorize="hasAnyRole('ROLE_ADMIN','ROLE_USER')"
									 class="btn btn-outline-secondary btn-sm"
									 th:href="@{/emisor/edit/}+${empresa.emisor.id}">
									<i class="fas fa-edit me-2"></i>Modificar
								</a>
							</div>
						</div>
					</div>
				</div>
			</div>

		</div>
	</main>

	<!-- Footer -->
	<footer th:replace="~{layout/layout :: footer}"></footer>
</div>

<!-- Scripts -->
<div th:replace="~{layout/layout :: scripts}"></div>

<!-- CSS específico de esta página -->
<link th:href="@{/css/pages/emisor-home.css}" rel="stylesheet" />
</body>
</html>