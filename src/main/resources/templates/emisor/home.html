<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head th:replace="~{layout/layout :: head}">
	<title>Empresas - SAMYX</title>
</head>
<body>
<div id="main-wrapper">
	<!-- Header -->
	<header th:replace="~{layout/layout :: header}"></header>

	<!-- Fragmento aside vacío para compatibilidad -->
	<aside th:fragment="sidebar" style="display: none;"></aside>

	<!-- Page wrapper -->
	<div class="page-wrapper">
		<!-- Page Header -->
		<div class="page-header">
			<div class="page-header-content">
				<h1 class="page-title">
					<i class="fas fa-building"></i>
					Mis Empresas
				</h1>
				<p class="page-subtitle">Selecciona una empresa para continuar</p>
			</div>
			<div class="page-header-actions">
				<a sec:authorize="hasAnyRole('ROLE_ADMIN','ROLE_USER')"
					 class="btn-action btn-gradient"
					 th:href="@{/emisor/registrar-empresa/}">
					<i class="fas fa-plus-circle"></i>
					<span>Registrar Nueva Empresa</span>
				</a>
			</div>
		</div>

		<!-- Container -->
		<div class="container-fluid">
			<!-- Grid de Empresas -->
			<div class="empresas-grid">
				<div class="empresa-card" th:each="k: ${listaEmisor}"
						 th:classappend="${!k.emisor.statusEmpresa} ? 'empresa-inactive' : ''">

					<!-- Card Header -->
					<div class="empresa-header">
						<div class="empresa-icon">
							<i class="fas fa-building"></i>
						</div>
						<div class="empresa-status"
								 th:classappend="${k.emisor.statusEmpresa} ? 'status-active' : 'status-inactive'">
							<span th:text="${k.emisor.statusEmpresa} ? 'Activa' : 'Inactiva'"></span>
						</div>
					</div>

					<!-- Card Body -->
					<div class="empresa-body">
						<h3 class="empresa-name" th:text="${k.emisor.nombreRazonSocial}"></h3>

						<div class="empresa-info">
							<div class="info-item">
								<i class="fas fa-id-card"></i>
								<span class="info-label">Identificación:</span>
								<span class="info-value" th:text="${k.emisor.identificacion}"></span>
							</div>

							<div class="info-item">
								<i class="fas fa-envelope"></i>
								<span class="info-label">Correo:</span>
								<span class="info-value" th:text="${k.emisor.email}"></span>
							</div>

							<div class="info-item"
									 th:if="${k.emisor.fechaCaducidadCert != null and #strings.length(k.emisor.fechaCaducidadCert) > 0}">
								<i class="fas fa-key"></i>
								<span class="info-label">Llave vence:</span>
								<span class="info-value fecha-caducidad"
											th:text="${#dates.format(k.emisor.fechaCaducidadCert, 'dd/MM/yyyy')}"></span>
							</div>
						</div>
					</div>

					<!-- Card Actions -->
					<div class="empresa-actions">
						<a sec:authorize="hasAnyRole('ROLE_ADMIN','ROLE_USER')"
							 class="btn-card btn-edit"
							 th:href="@{/emisor/edit/}+${k.emisor.id}"
							 data-tooltip="Modificar empresa">
							<i class="fas fa-edit"></i>
							<span>Modificar</span>
						</a>

						<a class="btn-card btn-access"
							 th:href="@{/emisor/ingresar/}+${k.emisor.id}"
							 data-tooltip="Ingresar a la empresa">
							<i class="fas fa-sign-in-alt"></i>
							<span>Ingresar</span>
						</a>
					</div>
				</div>
			</div>

			<!-- Empty State -->
			<div class="empty-state" th:if="${#lists.isEmpty(listaEmisor)}">
				<div class="empty-icon">
					<i class="fas fa-building"></i>
				</div>
				<h3>No hay empresas registradas</h3>
				<p>Comienza registrando tu primera empresa</p>
				<a sec:authorize="hasAnyRole('ROLE_ADMIN','ROLE_USER')"
					 class="btn-gradient"
					 th:href="@{/emisor/registrar-empresa/}">
					<i class="fas fa-plus-circle"></i>
					Registrar Nueva Empresa
				</a>
			</div>

			<!-- Paginación -->
			<nav th:replace="~{layout/paginator-nav :: paginator}"></nav>
		</div>
	</div>

	<!-- Footer -->
	<footer th:replace="~{layout/layout :: footer}"></footer>
</div>

<!-- Scripts -->
<div th:replace="~{layout/layout :: scripts}"></div>

<!-- CSS específico de esta página -->
<link th:href="@{/css/pages/emisor-home.css}" rel="stylesheet" />

<!-- JavaScript específico de esta página -->
<script th:src="@{/js/pages/emisor-home.js}"></script>
</body>
</html>